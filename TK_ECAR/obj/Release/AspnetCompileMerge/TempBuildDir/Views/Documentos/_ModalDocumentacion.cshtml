@using resourceView = TK_ECAR.Content.resources

@using (Html.BeginForm("GuardarDocumentacion", "Documentos", null, FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "stripHtml('formDocumentacion')", @id= "formDocumentacion" }))
{ @Html.AntiForgeryToken()
    
        <div class="modal fade" id="modalDocumentacion" role="dialog">
            <div class="vertical-alignment-helper">
                <div class="modal-dialog  vertical-align-center">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                <span class="modal-header-logo"></span>
                            </button>
                            <h4 class="modal-title" id="modaltitleDocumentacion"> </h4>
                        </div>
                         
                        <div class="modal-body"> 
                            @*<div id="toast-container"></div>*@              
                            <div id="modalbodyDocumentacion"></div> 
                            
                        </div>                             
                        <div class="modal-footer">
                            <button type="submit" id="aceptarDocumentacion" class="btn btn-default">@resourceView.TK_ECAR_Resource.AccionAceptar</button>
                            <button type="button" class="btn btn-cancel" data-dismiss="modal">@resourceView.TK_ECAR_Resource.AccionCerrar</button>
                         </div>

                    </div>
                </div>
            </div>
        </div>
      
}

<script type="text/javascript">
    var textError = '<li>texto</li>';

    $(document).ready(function () {
        $("#formDocumentacion").submit(function (e) {
            if ($("#formDocumentacion").valid()) {//validamos el form
                LimpiaValidationSummary();
                if ($("#FileUploadDocumentacion_download").val() != "") {
                    var formData = new FormData(this);
                    var uRl = '@Url.Action("Index", "Documentos")';
                    $.ajax({
                        type: this.method,
                        url: this.action,
                        data: formData,
                        contentType: false,
                        processData: false,

                        success: function (data) {
                            ajaxSuccessDocumentacion();
                            setTimeout(function () { window.location.replace(uRl) }, 1000);
                        },
                        error: function (error) {
                            ajaxErrorDocumentacion();
                        }
                    });
                }
                else {
                    $("#divValidationSummaryPanel_body ul").append(textError.replace("texto", '@Html.Raw(@resourceView.ModelsResources.RequiredFile)'));
                    $('#divValidationSummary').addClass("validation-summary-errors").removeClass("validation-summary-valid");
                    $("#divValidationSummary").show();
                }
            }

            e.preventDefault();

        });
    });


    function ajaxSuccessDocumentacion() {

        @*toastr["info"]("@resourceView.toastrInfDocumentoCorrecto");*@
        notify('@resourceView.TK_ECAR_Resource.toastrInfAccionOK', 'i');

        $('#modalDocumentacion').modal('hide');
    }
    function ajaxErrorDocumentacion() {

        @*toastr["error"]("@resourceView.toastrInfDocumentoError");*@
        notify('@resourceView.TK_ECAR_Resource.toastrInfDocumentoError', 'e');
    }


</script>
