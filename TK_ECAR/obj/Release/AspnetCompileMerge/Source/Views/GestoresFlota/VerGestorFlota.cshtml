@model IEnumerable<TK_ECAR.Models.GestoresFlotaModel>
@using resourceView = TK_ECAR.Content.resources.TK_ECAR_Resource

<div class="row">
    <div class="col-sm-12">
        <div class="infoGestFlotaPub">
            <h3>@resourceView.TitleGestoresFlota</h3>
            <p>@resourceView.TitleGestorFlotaInf</p>
        </div>
    </div>
  
</div>

@*var actionLinkDelete = '@Ajax.ActionLink("JSTITLEACTION", "BorrarDocumento", "Documentos", new { numEmpleado = "JSVARTIPO" },
    new AjaxOptions
    {
        UpdateTargetId = "modalbodyGestorFlota",
        OnSuccess = "showModalGestorFlota();",
        OnComplete = "completeModal()",
        InsertionMode = InsertionMode.Replace,
        OnBegin = "setTitleModal('JSTITLEMODAL')"
    })';*@

<div class="row">

    <div id="menu">
        <div class="panel list-group">
            <a href="#" id="cabeceraLista" class="list-group-item" data-toggle="collapse" data-target="#sm" data-parent="#menu" style="background-color: #d9dee8;">
                <span class="h3">@resourceView.TitleGestoresFlotaLista</span>
            </a>
            <br />
            @if (Model != null)
            {
                foreach (var item in Model)
                {
                    <div class="row col-sm-12">
                        <div class="notice notice-Lightgreen sublinks col-sm-12" style="margin-left: 15px;">
                            <div class="sublinks col-sm-12">
                                @Ajax.ActionLink(item.Nombre, "BorrarGestorFlota", "GestoresFlota", new { numEmpleado = item.NumeroEmpleado },
                                        new AjaxOptions
                                        {
                                            UpdateTargetId = "modalbodyVerGestorFlota",
                                            OnSuccess = "showModalVerGestorFlota();",
                                            OnComplete = "completeModal()",
                                            InsertionMode = InsertionMode.Replace,
                                            OnBegin = "setTitleModal('Gestor Flota')"
                                        })
                                <div class="row">
                                    <div class="col-sm-3 pull-center">
                                        <div class="form-group">
                                            @item.Puesto
                                        </div>
                                    </div>
                                    <div class="col-sm-2 pull-center">
                                        <div class="form-group">
                                            @TK_ECAR.Content.resources.ModelsResources.lblTelefono1
                                            <div>
                                                @item.Telefono1
                                            </div>
                                        </div>
                                    </div>
                                    @if (!string.IsNullOrEmpty(item.Telefono2))
                                    {
                                        <div class="col-sm-2 pull-center">
                                            <div class="form-group">
                                                @TK_ECAR.Content.resources.ModelsResources.lblTelefono2
                                                <div>
                                                    @item.Telefono2
                                                </div>
                                            </div>
                                        </div>
                                    }

                                </div>
                            </div>

                        </div>
                    </div>
                }
            }
            <br />
        </div>
    </div>
</div>


<div class="modal fade" id="modalVerGestorFlota" role="dialog">
    <div class="vertical-alignment-helper">
        <div class="modal-dialog  vertical-align-center">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        <span class="modal-header-logo"></span>
                    </button>
                    <h4 class="modal-title" id="modaltitleVerGestorFlota"> </h4>
                </div>

                <div class="modal-body">
                    <div id="modalbodyVerGestorFlota"></div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-cancel" data-dismiss="modal">@resourceView.AccionCerrar</button>
                </div>

            </div>
        </div>
    </div>
</div>

<div id="tree">

</div>
  

@section Scripts {

<link rel="stylesheet" type="text/css" href='@Styles.Url("~/bootstrapTreeviewCSSCdnPath")'>
<script src='@Scripts.Url("~/bootstrapTreeviewCdnPath")'> </script>

    <script type="text/javascript">

        var TreeViewGestores;

        //https://github.com/jonmiles/bootstrap-treeview
        $(document).ready(function () {
      
            @*var _Data;

            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetJsonDataTreeviewGestoresFlota", "GestoresFlota")',
                async: false,             
                success: function (data) {
                    _Data = jQuery.parseJSON(JSON.stringify(data));
                 }
            });

            $TreeViewGestores = $('#tree').treeview({
                                    data: _Data, //data,         // data is not optional
                                    //showTags: true,
                                });

            $TreeViewGestores.treeview('collapseAll', { silent: true });

            //******** Acciones en treeView
            //Buscar en treeView
            var search = function (e) {
                var pattern = $('#input-search').val();
                var options = {
                    ignoreCase: true,
                    exactMatch: false,
                    revealResults: true
                };
                var results = $('#tree').treeview('search', [pattern, options]);
            }

            $('#btn-search').on('click', search);
            $('#input-search').on('keyup', search);

            $('#btn-clear-search').on('click', function (e) {
                $TreeViewGestores.treeview('clearSearch');
                $('#input-search').val('');
                $('#search-output').html('');
            });

            //Cerrar todos los nodos
            $('#cerrarTodosLosNodos').on('click', function (e) {
                $TreeViewGestores.treeview('collapseAll', { silent: true });
            });

            //Abrir todos los nodos
            $('#abrirTodosLosNodos').on('click', function (e) {
                var levels = $('#select-expand-all-levels').val();
                $TreeViewGestores.treeview('expandAll', { levels: levels, silent: true });
            });

            //Selección nodo
            $TreeViewGestores.treeview({
                data: _Data,
                multiSelect: false,
                onNodeSelected: function (event, node) {
                    alert(node.id);
                },
                onNodeUnselected: function (event, node) {
                }
            });*@


        });

        function showModalVerGestorFlota() {
            $('#modalVerGestorFlota').modal('show');
        }
        function setTitleModal(title) {
            $('#modaltitleVerGestorFlota').text(title);
        }

        //function completeModal() {
        //    //para que funcione los validadores a la viewpartial recien creada.
        //    //reconstruye el DOM con los validadores de los campos nuevos
        //    $("form").removeData("validator");
        //    $("form").removeData("unobtrusiveValidation");
        //    $.validator.unobtrusive.parse("form");
        //    $("form").validate();
        //}
    </script>
}